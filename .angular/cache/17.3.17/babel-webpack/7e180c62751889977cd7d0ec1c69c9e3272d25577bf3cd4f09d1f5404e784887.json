{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Injectable } from \"@angular/core\";\nimport { HttpParams } from \"@angular/common/http\";\nlet TrabajoService = class TrabajoService {\n  http;\n  // Ajustado a tu configuración: puerto 8081 y context-path /api/alumnos\n  API_URL = \"http://localhost:8081/api/alumnos/trabajos\";\n  constructor(http) {\n    this.http = http;\n  }\n  // Crear un nuevo trabajo\n  crearTrabajo(trabajoData, pdfFile, codigoFile) {\n    const formData = new FormData();\n    // Agregar datos del trabajo (nombres exactos que espera tu DTO)\n    formData.append(\"titulo\", trabajoData.titulo);\n    formData.append(\"resumen\", trabajoData.resumen);\n    formData.append(\"semestre\", trabajoData.semestre.toString());\n    formData.append(\"usuarioId\", trabajoData.usuarioId.toString());\n    formData.append(\"estadoId\", \"1\"); // Estado inicial - ajusta según tu BD\n    // Campos opcionales\n    if (trabajoData.carreraId) {\n      formData.append(\"carreraId\", trabajoData.carreraId.toString());\n    }\n    if (trabajoData.materiaId) {\n      formData.append(\"materiaId\", trabajoData.materiaId.toString());\n    }\n    // Agregar archivos si existen\n    if (pdfFile) {\n      formData.append(\"filePdf\", pdfFile, pdfFile.name);\n    }\n    if (codigoFile) {\n      formData.append(\"fileCodigo\", codigoFile, codigoFile.name);\n    }\n    console.log(\"Enviando datos al backend:\", {\n      titulo: trabajoData.titulo,\n      resumen: trabajoData.resumen,\n      semestre: trabajoData.semestre,\n      usuarioId: trabajoData.usuarioId,\n      carreraId: trabajoData.carreraId,\n      materiaId: trabajoData.materiaId,\n      pdfFile: pdfFile?.name,\n      codigoFile: codigoFile?.name\n    });\n    return this.http.post(this.API_URL, formData);\n  }\n  // Obtener trabajos del usuario\n  obtenerTrabajosDelUsuario(usuarioId) {\n    return this.http.get(`${this.API_URL}/usuario/${usuarioId}`);\n  }\n  // Obtener trabajo por ID\n  obtenerTrabajoPorId(id) {\n    return this.http.get(`${this.API_URL}/${id}`);\n  }\n  // Actualizar trabajo\n  actualizarTrabajo(id, trabajoData, pdfFile, codigoFile) {\n    const formData = new FormData();\n    formData.append(\"titulo\", trabajoData.titulo);\n    formData.append(\"resumen\", trabajoData.resumen);\n    formData.append(\"semestre\", trabajoData.semestre.toString());\n    if (trabajoData.carreraId) {\n      formData.append(\"carreraId\", trabajoData.carreraId.toString());\n    }\n    if (trabajoData.materiaId) {\n      formData.append(\"materiaId\", trabajoData.materiaId.toString());\n    }\n    if (pdfFile) {\n      formData.append(\"filePdf\", pdfFile, pdfFile.name);\n    }\n    if (codigoFile) {\n      formData.append(\"fileCodigo\", codigoFile, codigoFile.name);\n    }\n    return this.http.put(`${this.API_URL}/${id}`, formData);\n  }\n  // Eliminar trabajo\n  eliminarTrabajo(id, usuarioId) {\n    const params = new HttpParams().set(\"usuarioId\", usuarioId.toString());\n    return this.http.delete(`${this.API_URL}/${id}`, {\n      params\n    });\n  }\n  // Descargar archivo\n  descargarArchivo(trabajoId, tipoArchivo, usuarioId) {\n    const params = new HttpParams().set(\"usuarioId\", usuarioId.toString());\n    return this.http.get(`${this.API_URL}/${trabajoId}/descargar/${tipoArchivo}`, {\n      params,\n      responseType: \"blob\"\n    });\n  }\n};\nTrabajoService = __decorate([Injectable({\n  providedIn: \"root\"\n})], TrabajoService);\nexport { TrabajoService };","map":{"version":3,"names":["Injectable","HttpParams","TrabajoService","http","API_URL","constructor","crearTrabajo","trabajoData","pdfFile","codigoFile","formData","FormData","append","titulo","resumen","semestre","toString","usuarioId","carreraId","materiaId","name","console","log","post","obtenerTrabajosDelUsuario","get","obtenerTrabajoPorId","id","actualizarTrabajo","put","eliminarTrabajo","params","set","delete","descargarArchivo","trabajoId","tipoArchivo","responseType","__decorate","providedIn"],"sources":["C:\\Users\\albaa\\OneDrive\\Escritorio\\academic-works-system\\src\\app\\services\\trabajo.service.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\"\r\nimport { type HttpClient, HttpParams } from \"@angular/common/http\"\r\nimport type { Observable } from \"rxjs\"\r\n\r\nexport interface TrabajoDTO {\r\n  id?: number\r\n  titulo: string\r\n  resumen: string\r\n  semestre: number\r\n  publicado?: boolean\r\n  fechaEnvio?: string\r\n  fechaAprobacion?: string\r\n  comentariosRevision?: string\r\n  usuarioId: number\r\n  estadoId: number\r\n  materiaId?: number\r\n  carreraId?: number\r\n  archivoPdfOriginal?: string\r\n  codigoFuenteOriginal?: string\r\n}\r\n\r\nexport interface CarreraDTO {\r\n  id: number\r\n  nombre: string\r\n}\r\n\r\nexport interface MateriaDTO {\r\n  id: number\r\n  nombre: string\r\n  carreraId: number\r\n}\r\n\r\n@Injectable({\r\n  providedIn: \"root\",\r\n})\r\nexport class TrabajoService {\r\n  // Ajustado a tu configuración: puerto 8081 y context-path /api/alumnos\r\n  private readonly API_URL = \"http://localhost:8081/api/alumnos/trabajos\"\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  // Crear un nuevo trabajo\r\n  crearTrabajo(trabajoData: any, pdfFile?: File, codigoFile?: File): Observable<TrabajoDTO> {\r\n    const formData = new FormData()\r\n\r\n    // Agregar datos del trabajo (nombres exactos que espera tu DTO)\r\n    formData.append(\"titulo\", trabajoData.titulo)\r\n    formData.append(\"resumen\", trabajoData.resumen)\r\n    formData.append(\"semestre\", trabajoData.semestre.toString())\r\n    formData.append(\"usuarioId\", trabajoData.usuarioId.toString())\r\n    formData.append(\"estadoId\", \"1\") // Estado inicial - ajusta según tu BD\r\n\r\n    // Campos opcionales\r\n    if (trabajoData.carreraId) {\r\n      formData.append(\"carreraId\", trabajoData.carreraId.toString())\r\n    }\r\n\r\n    if (trabajoData.materiaId) {\r\n      formData.append(\"materiaId\", trabajoData.materiaId.toString())\r\n    }\r\n\r\n    // Agregar archivos si existen\r\n    if (pdfFile) {\r\n      formData.append(\"filePdf\", pdfFile, pdfFile.name)\r\n    }\r\n\r\n    if (codigoFile) {\r\n      formData.append(\"fileCodigo\", codigoFile, codigoFile.name)\r\n    }\r\n\r\n    console.log(\"Enviando datos al backend:\", {\r\n      titulo: trabajoData.titulo,\r\n      resumen: trabajoData.resumen,\r\n      semestre: trabajoData.semestre,\r\n      usuarioId: trabajoData.usuarioId,\r\n      carreraId: trabajoData.carreraId,\r\n      materiaId: trabajoData.materiaId,\r\n      pdfFile: pdfFile?.name,\r\n      codigoFile: codigoFile?.name,\r\n    })\r\n\r\n    return this.http.post<TrabajoDTO>(this.API_URL, formData)\r\n  }\r\n\r\n  // Obtener trabajos del usuario\r\n  obtenerTrabajosDelUsuario(usuarioId: number): Observable<TrabajoDTO[]> {\r\n    return this.http.get<TrabajoDTO[]>(`${this.API_URL}/usuario/${usuarioId}`)\r\n  }\r\n\r\n  // Obtener trabajo por ID\r\n  obtenerTrabajoPorId(id: number): Observable<TrabajoDTO> {\r\n    return this.http.get<TrabajoDTO>(`${this.API_URL}/${id}`)\r\n  }\r\n\r\n  // Actualizar trabajo\r\n  actualizarTrabajo(id: number, trabajoData: any, pdfFile?: File, codigoFile?: File): Observable<TrabajoDTO> {\r\n    const formData = new FormData()\r\n\r\n    formData.append(\"titulo\", trabajoData.titulo)\r\n    formData.append(\"resumen\", trabajoData.resumen)\r\n    formData.append(\"semestre\", trabajoData.semestre.toString())\r\n\r\n    if (trabajoData.carreraId) {\r\n      formData.append(\"carreraId\", trabajoData.carreraId.toString())\r\n    }\r\n\r\n    if (trabajoData.materiaId) {\r\n      formData.append(\"materiaId\", trabajoData.materiaId.toString())\r\n    }\r\n\r\n    if (pdfFile) {\r\n      formData.append(\"filePdf\", pdfFile, pdfFile.name)\r\n    }\r\n\r\n    if (codigoFile) {\r\n      formData.append(\"fileCodigo\", codigoFile, codigoFile.name)\r\n    }\r\n\r\n    return this.http.put<TrabajoDTO>(`${this.API_URL}/${id}`, formData)\r\n  }\r\n\r\n  // Eliminar trabajo\r\n  eliminarTrabajo(id: number, usuarioId: number): Observable<void> {\r\n    const params = new HttpParams().set(\"usuarioId\", usuarioId.toString())\r\n    return this.http.delete<void>(`${this.API_URL}/${id}`, { params })\r\n  }\r\n\r\n  // Descargar archivo\r\n  descargarArchivo(trabajoId: number, tipoArchivo: string, usuarioId: number): Observable<Blob> {\r\n    const params = new HttpParams().set(\"usuarioId\", usuarioId.toString())\r\n    return this.http.get(`${this.API_URL}/${trabajoId}/descargar/${tipoArchivo}`, {\r\n      params,\r\n      responseType: \"blob\",\r\n    })\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}